unit c;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls;

type
  TXY = record
    X: integer;
    Y: integer;
  end;

  TArr = array [1 .. 4, 1 .. 2, 1 .. 2] of integer;

  TOffset = record
    LeftArm1: TXY;
    LeftArm2: TXY;
    RightArm1: TXY;
    RightArm2: TXY;
    LeftLeg1: TXY;
    LeftLeg2: TXY;
    RightLeg1: TXY;
    RightLeg2: TXY;
  end;

  TForm1 = class(TForm)
    Button1: TButton;
    Timer1: TTimer;
    Button2: TButton;
    procedure FormPaint(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure Button2Click(Sender: TObject);

  private
    { Private declarations }
    FrameIndex: integer; // »ндекс текущего кадра
    Offset: TOffset; // —мещени€ дл€ каждого кадра
  public
    { Public declarations }
    procedure DrawFrame;
  end;

  TMyCanvas = class(TCanvas)
   procedure DrawCharacter(X, Y, Xpr, Ypr, LeftArm1X, LeftArm1Y,
  LeftArm2X, LeftArm2Y, RightArm1X, RightArm1Y, RightArm2X, RightArm2Y,
  LeftLeg1X, LeftLeg1Y, LeftLeg2X, LeftLeg2Y, RightLeg1X, RightLeg1Y,
  RightLeg2X, RightLeg2Y: integer);
  end;

var
  Form1: TForm1;
  X, Y: integer;
  IsDrawingFirst: boolean;
  MC: TMyCanvas;

implementation

{$R *.dfm}

procedure TMyCanvas.DrawCharacter(X, Y, Xpr, Ypr, LeftArm1X, LeftArm1Y,
  LeftArm2X, LeftArm2Y, RightArm1X, RightArm1Y, RightArm2X, RightArm2Y,
  LeftLeg1X, LeftLeg1Y, LeftLeg2X, LeftLeg2Y, RightLeg1X, RightLeg1Y,
  RightLeg2X, RightLeg2Y: integer);
begin
  // голова
  Form1.Canvas.Ellipse(47 * Xpr + X, 40 * Ypr + Y, 57 * Xpr + X, 30 * Ypr + Y);

  // туловище
  Form1.Canvas.MoveTo(52 * Xpr + X, 40 * Ypr + Y);
  Form1.Canvas.LineTo(52 * Xpr + X, 62 * Ypr + Y); // конец тулова

  // лева€ рука
  Form1.Canvas.Polyline([Point(52 * Xpr + X, 45 * Ypr + Y),
    Point(LeftArm1X * Xpr + X, LeftArm1Y * Ypr + Y),
    Point(LeftArm2X * Xpr + X, LeftArm2Y * Ypr + Y)]);

  // права€ рука
  Form1.Canvas.Polyline([Point(52 * Xpr + X, 45 * Ypr + Y),
    Point(RightArm1X * Xpr + X, RightArm1Y * Ypr + Y),
    Point(RightArm2X * Xpr + X, RightArm2Y * Ypr + Y)]);

  // лева€ нога
  Form1.Canvas.Polyline([Point(52 * Xpr + X, 62 * Ypr + Y),
    Point(LeftLeg1X * Xpr + X, LeftLeg1Y * Ypr + Y),
    Point(LeftLeg2X * Xpr + X, LeftLeg2Y * Ypr + Y)]);

  // права€ нога
  Form1.Canvas.Polyline([Point(52 * Xpr + X, 62 * Ypr + Y),
    Point(RightLeg1X * Xpr + X, RightLeg1Y * Ypr + Y),
    Point(RightLeg2X * Xpr + X, RightLeg2Y * Ypr + Y)]);
end;

// ћетод дл€ рисовани€ текущего кадра
procedure TForm1.Button2Click(Sender: TObject);
begin
  Form1.Canvas.Ellipse(470, 400, 570, 300); // голова
  Form1.Canvas.MoveTo(520, 400); // от головы
  Form1.Canvas.LineTo(520, 610); // конец тулова
  Form1.Canvas.Polyline([Point(520, 450), Point(480, 500), Point(470, 460)]);
  // лева€ рука
  Form1.Canvas.Polyline([Point(520, 450), Point(540, 500), Point(570, 460)]);
  // права€ рука
  Form1.Canvas.Polyline([Point(520, 610), Point(530, 700), Point(500, 750)]);
  // права€ нога
  Form1.Canvas.Polyline([Point(520, 610), Point(570, 690), Point(560, 730)]);
  // лева€ нога
  Form1.Canvas.Polyline([Point(510, 490), Point(410, 630)]); // палка
  Form1.Canvas.Polyline([Point(510, 490), Point(650, 320)]); // палка
end;

procedure TForm1.DrawFrame;
begin
  MC := TMyCanvas.Create; // используем конструктор родительского класса
  MC.Handle := Canvas.Handle; // назначаем холст окна областью вывода
  Canvas.FillRect(ClientRect); // ќчистка экрана

  case FrameIndex of
    1:
       MC.DrawCharacter(100+x, 100, 10,10, 45,49,50,52,56,50,62,47,48,70,43,73,57,69,57,74);
    2:
      MC.DrawCharacter(100+x, 100, 10,10, 45,49,50,52,56,50,62,47,48,70,43,73,57,69,57,74);
    3:
     MC.DrawCharacter(100+x, 100, 10,10, 45,49,50,52,56,50,62,47,48,70,43,73,57,69,57,74);
    4:
      MC.DrawCharacter(100+x, 100, 10,10, 45,49,50,52,56,50,62,47,48,70,43,73,57,69,57,74);
  end;

end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  FrameIndex := 1; // Ќачинаем с первого кадра
  Timer1.Enabled := True; // «апускаем таймер
  X := 100;
  Y := 100;
  Timer1.Enabled := True;
end;

procedure TForm1.FormPaint(Sender: TObject);
begin
  Canvas.Brush.Color := clWhite;
  Color := clWhite;
  Canvas.Pen.Mode := pmNotXor;
end;

procedure TForm1.Timer1Timer(Sender: TObject);
begin
  DrawFrame; // –исуем текущий кадр
  FrameIndex := FrameIndex mod 4 + 1; // ѕереход к следующему кадру
  X := X + 8;
  if (X >= ClientWidth - 20) then
    Timer1.Enabled := false;
end;

end.
